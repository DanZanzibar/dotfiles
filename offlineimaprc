[general]
accounts = work, personal
pythonfile = ~/.offlineimap/.helper.py

[Account work]
localrepository = Local-work
remoterepository = Remote-work

[Repository Local-work]
type = Maildir
localfolders = ~/.mail/work/

[Repository Remote-work]
type = IMAP
remotehost = outlook.office365.com
remoteusereval = get_work_username()
sslcacertfile = /etc/ssl/certs/ca-certificates.crt
auth_mechanisms = XOAUTH2
oauth2_client_id_eval = get_client_id()
oauth2_client_secret_eval = get_client_secret()
oauth2_refresh_token_eval = get_refresh_token()
oauth2_request_url = https://login.microsoftonline.com/4a8c66e5-120a-4192-a8b9-83c66d812331/oauth2/v2.0/token

[Account personal]
localrepository = Local-personal
remoterepository = Remote-personal

[Repository Local-personal]
type = Maildir
localfolders = ~/.mail/personal

[Repository Remote-personal]
type = IMAP
remotehost = imap.gmail.com
remoteusereval = get_username('personal')
remotepasseval = get_password('personal')
sslcacertfile = /etc/ssl/certs/ca-certificates.crt
auth_mechanisms = PLAIN
